# 香风智乃萌战应援群机器人

## 启动

- 安装 Java 运行时（版本必须 >= 11）
- 从 [Releases](https://github.com/iTXTech/mirai-console-loader/releases) 下载最新版本的`MCL`，解压到此文件夹
- 安装 Node.js
- 运行 ```npm i``` 或 ```yarn```（如果已经安装了 yarn）
- 先在此文件夹运行 ```npm run start:server```，再在新的终端下切换到此文件夹，运行 ```npm run start:client```

## 模块规划

### entry
- [ ] 管理员输入```管理指令提示```可以输出所有可用的管理指令列表；输入```指令提示```可以输出所有可用的模块列表，进一步输入```指令提示 <模块名>```可以输出该模块的具体指令用法
- [ ] 管理员可以通过指令```检查模块状态 <模块名>```查看某模块的统计信息与是否开关；通过指令```打开模块 <模块名>```与```关闭模块 <模块名>```对模块进行开关操作

### goodMorning
- [ ] 早 5 点至 8 点之间的群友签到功能，要求匹配到“早”、“早安”、“早上好”时会自动进行响应，并说出今天是第几个喊早的（相当于签到功能；仅记录前 30 名，30 名之后的只会回复“早”而不会报告排名）
- [ ] 在其它时间，如果触发此模块，在一小时之内只会回复一次不在早上时间的提示
- [ ] ~~如果说早的是周一，则会同时按照英国时区与中国时区进行计算——即不论周一是在英国的早上还是中国的早上，都仍然会回复早安（不计入排名）~~如果有群员不在中国内陆，可以通过指令```时区设置 <国家/地区名>```进行定制化调整；以这种方式调整时区的群员在问候早安时不会计入排名
- [ ] 输入```早起排行```可以输出一份前 10 名早起人的名单排行；仅在当天 8 点以后可以执行，并且 1 分钟内只能被执行一次

### repeater
- [ ] 当有两个或两个以上群友重复同一句话时，自动触发复读（同一片上下文的复读只会触发一次；同一段文字的复读在十分钟之内只会触发一次）

### messageKeeper
- [ ] 输入```提醒 @某成员 内容```后，会自动创建提醒，并在目标成员下一次说话时自动重新发送提醒文本

### imageLibrary
- [ ] 输入```来点兔子```后，机器人会自动从库中发送一张智乃图片；输入```储存图片```后再发送一张图片后，机器人会自动将图片保存入库（图片采用 SHA3 上指纹，保证图片不重复；当保存重复图片时，机器人会进行提醒；图片直接储存进文件系统，不经过数据库）

### ticketCollector
- [ ] 萌战收票时段，机器人接受私聊，自动对提交的票根图片与文本数据进行储存，并回复感谢信息（待实验）

### judgement（~~夹击妹抖~~）
- [ ] 自动对违规文本进行检测（敏感词词库来源暂未定型），并进行撤回与私聊警告操作（可以通过回复机器人以解除对某个关键字的屏蔽；需要审核）；自动对违规图片进行检测（使用腾讯色图识别 SDK；所有进入图库的重复图片不进行识别，以节省配额），色情识别率超过 60% 时进行撤回与私聊警告操作（同样可以通过回复机器人以解除屏蔽）

### messageLibrary
- [ ] 自动对群聊天内容进行记录与存档

### twitterMonitor
- [ ] 点兔官方 twitter 的自动推送，直接发送到群里（走的翻墙通道暂时用我自己的；使用 twitter 公开 api，每一小时检查一次）（带日转中翻译，使用百度翻译 API，token 也用我自己的）

### phonograph
- [ ] 输入```点歌 <歌曲名>```，会自动尝试从音乐平台拉取音频，并以语音的形式发送到群里
